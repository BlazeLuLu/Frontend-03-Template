# W02 浏览器工作原理
- 浏览器总论
	- 浏览器工作原理总论
		- 浏览器基本渲染流程
			- URL --(HTTP)-->HTML--(parse)-->DOM--(CSS computing)-->DOM with CSS--(layout)-->DOM with position--(render)-->Bitmap
- 状态机
	- 有限状态机
		- 每一个状态都是一个机器（解耦、独立）
			- 每一个机器可以做计算、存储、输出……
			- 所有机器接受的输入是一致的
			- 状态机的每一个机器本身没有状态（纯函数）
				- 函数不能读变量
		- 每一个机器知道下一个状态
			- 每个机器都有确定的下一个状态（Moore）
			- 每个机器根据输入决定下一个状态（Mealy）
	- 不使用状态机处理字符
		-在一个字符串中，找到字符‘a’
		- 不使用正则表达式，在一个字符串中，找到字符‘ab’
		-不使用正则表达式，在一个字符串中，找到字符‘abcdef’
	- 使用状态机处理字符串
		-每找到一个字符，就切换一个状态
		- 用状态机处理诸如“abcabx”这样的字符串
		- 用状态机完成“abababx”的处理
		- 如何用状态机处理完全未知的pattern？
			-字符串KMP算法
- HTTP请求
	- HTTP的协议解析
		- ISO-OSI七层网络模型
			- 应用层
			- 表示层
			- 会话层
			- 传输层
			- 网络层
			- 数据链路层
			- 物理层
		
			- HTTP
				- require(“http”)
			- TCP
				- require(“net”)
			- Internet
			- 4G/5G/Wi-fi
		- TCP与IP的一些基础知识
			- 传输层（TCP）
				- 流
				- 端口
				- require(“net”)
			- 网络层（IP）
				- 包
				- 端口
				- libnet（构造、发送IP包）/libpcap（抓IP包）
		- HTTP
			- Request
				- 需要先发送request，才会得到response，且request与response是一对一的关系
			- Response
	- 服务端的环境准备
		- 服务端代码
		- HTTP协议
			- 文本型协议
			- 请求
				- request line
					- 方法
						- POST
						- GET
					- 路径
					- 版本
				- request headers
					- k-v结构
					- 空行结束
				- request body
					- Content-type决定
	- 实现一个HTTP的请求
		- 设计一个HTTP请求的类
		- content type是一个必要的字段，要有默认值
		- body是KV格式
		- 不同的content-type影响body的格式
	- send函数编写
		- 在Request的构造器中收集必要的信息
		- 设计一个send函数，把请求真实发送到服务器
		- send函数应该是异步的，所以返回Promise
		- 了解response格式
			- status line
				- http协议
				- 状态码
				- 状态文本
			- headers
			- 空行分隔
			- body
	- 发送请求
		- 设计支持已有的connection或者自己心间connection
		- 收到数据传给parser
		- 根据parser的状态resolve Promise
	- response解析
		- Response必须分段构造，所以我们要用一个ResponseParser来“装配”
		- RresponseParser分段处理ResponseText，我们用状态机来分析文本的结构
	- response body解析
		- Response的body可能根据Content-Type有不同的结构，因此我们会采用Parser的结构来解决问题
		- 以TrunkedBodyParser为例，我们同样用状态机来处理body的格式